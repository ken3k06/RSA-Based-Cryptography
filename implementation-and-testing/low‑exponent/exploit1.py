<<<<<<< HEAD
from pwn import * 
r = process(['python3', 'server.py'])
context.log_level = 'debug'
# r = remote('HOST', PORT)
from Crypto.Util.number import * 
from sage.all import crt, Integer
from math import lcm
def fast_crt(X, M, segment_size=8):
    assert len(X) == len(M)
    assert len(X) > 0
    while len(X) > 1:
        X_ = []
        M_ = []
        for i in range(0, len(X), segment_size):
            if i == len(X) - 1:
                X_.append(X[i])
                M_.append(M[i])
            else:
                X_.append(crt(X[i:i + segment_size], M[i:i + segment_size]))
                M_.append(lcm(*M[i:i + segment_size]))
        X = X_
        M = M_

    return X[0], M[0]

Xs = []
Ns = []
while len(Xs) <= 31:
    r.recvuntil(b'option:\n')
    r.sendline(b'1')
    r.recvuntil(b'N = ')
    N = int(r.recvline().strip())
    r.recvuntil(b'c = ')
    c = int(r.recvline().strip())
    Xs.append(c)
    Ns.append(N)
print(Xs)
m_30, _ = fast_crt(Xs, Ns, segment_size=8)
print(long_to_bytes(Integer(m_30).nth_root(30)))


=======
from Cryptodome.Util.number import *
from sage.all import *
from itertools import combinations
from sympy.ntheory.modular import crt
from gmpy2 import iroot
from pathlib import Path



def extract_nc_pairs(file_path):
    nc_pairs = []
    with open(file_path, 'r') as file:
        lines = file.readlines()

    n = c = None
    for line in lines:
        line = line.strip()
        if line.startswith("n ="):
            n = int(line.split("=", 1)[1].strip())
        elif line.startswith("c ="):
            c = int(line.split("=", 1)[1].strip())
        if n is not None and c is not None:
            nc_pairs.append((n, c))
            n = c = None

    return nc_pairs

def find_m_with_nc(nc_pairs):
    for combo in combinations(nc_pairs, 3):
        moduli = [n for n, c in combo]
        remainders = [c for n, c in combo]
        result = crt(moduli, remainders)
        if result is not None:
            m = result[0]  
            root, is_exact = iroot(m, 3)
            if is_exact:
                decode_message=long_to_bytes(int(root))
                print(f"m = {m}, cube root = {int(root)}")
                print(f"Flag lÃ : {decode_message}")
current_dir = Path.cwd() 
file_path = current_dir / "output1.txt"
nc_pairs = extract_nc_pairs(file_path)
find_m_with_nc(nc_pairs)
>>>>>>> origin/fix-rm-cve
