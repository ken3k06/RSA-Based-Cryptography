from pwn import * 
r = process(['python3', 'server.py'])
context.log_level = 'debug'
# r = remote('HOST', PORT)
from Crypto.Util.number import * 
from sage.all import crt, Integer
from math import lcm
def fast_crt(X, M, segment_size=8):
    assert len(X) == len(M)
    assert len(X) > 0
    while len(X) > 1:
        X_ = []
        M_ = []
        for i in range(0, len(X), segment_size):
            if i == len(X) - 1:
                X_.append(X[i])
                M_.append(M[i])
            else:
                X_.append(crt(X[i:i + segment_size], M[i:i + segment_size]))
                M_.append(lcm(*M[i:i + segment_size]))
        X = X_
        M = M_

    return X[0], M[0]

Xs = []
Ns = []
while len(Xs) <= 31:
    r.recvuntil(b'option:\n')
    r.sendline(b'1')
    r.recvuntil(b'N = ')
    N = int(r.recvline().strip())
    r.recvuntil(b'c = ')
    c = int(r.recvline().strip())
    Xs.append(c)
    Ns.append(N)
print(Xs)
m_30, _ = fast_crt(Xs, Ns, segment_size=8)
print(long_to_bytes(Integer(m_30).nth_root(30)))


