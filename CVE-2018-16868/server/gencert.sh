mkdir -p /lab && cd /lab
certtool --generate-privkey --rsa --bits 2048 --outfile server.key

cat > server.tmpl <<'EOF'
organization = "lab"
cn = "localhost"
tls_www_server
expiration_days = 365
EOF

certtool --generate-self-signed \
  --load-privkey server.key \
  --template server.tmpl \
  --outfile server.crt

gnutls-serv --port 4443 \
  --x509certfile server.crt --x509keyfile server.key \
  --priority "NORMAL:-KX-ALL:+RSA:-VERS-ALL:+VERS-TLS1.2"
